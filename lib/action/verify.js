"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return verifyAction;
    }
});
require("../preamble");
const _occammodel = require("occam-model");
const _occamlanguages = require("occam-languages");
const _fileContext = require("../utilities/fileContext");
const _releaseContext = require("../utilities/releaseContext");
const { createReleaseContext, verifyReleaseContext, initialiseReleaseContext } = _occamlanguages.verificationUtilities;
async function verifyAction(name, log) {
    const callback = async (context, filePath, lineIndex)=>{
    ///
    }, releaseContextMap = {}, context = {
        log,
        callback,
        releaseContextMap,
        FileContextFromFilePath: _fileContext.FileContextFromFilePath,
        releaseContextFromDependency: _releaseContext.releaseContextFromDependency
    };
    // try {
    const dependentNames = [], dependency = _occammodel.Dependency.fromName(name), releaseContextCreated = await createReleaseContext(dependency, dependentNames, context);
    if (!releaseContextCreated) {
        log.warning(`The '${name}' project or package cannot be created.`);
        return;
    }
    const releaseName = name, releaseContext = releaseContextMap[releaseName], released = releaseContext.isReleased();
    if (released) {
        log.warning(`The '${name}' package does not need to be verified.`);
        return;
    }
    initialiseReleaseContext(dependency, context);
    const dependentName = null, dependentReleased = false, releaseContextVerifies = await verifyReleaseContext(releaseName, dependentName, dependentReleased, releaseContextMap);
    if (!releaseContextVerifies) {
        log.warning(`The '${name}' project or package cannot be verified.`);
        return;
    }
    const json = releaseContext.toJSON(), entries = releaseContext.getEntries(), customGrammar = releaseContext.getCustomGrammar(), releaseContexts = [
        releaseContext
    ];
    _occamlanguages.ReleaseContext.fromLogNameJSONEntriesCallbackAndCustomGrammar(log, name, json, entries, callback, customGrammar).initialise(releaseContexts, _fileContext.FileContextFromFilePath);
// }
// catch (error) {
//   log.error(error);
// }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hY3Rpb24vdmVyaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgXCIuLi9wcmVhbWJsZVwiO1xuXG5pbXBvcnQgeyBEZXBlbmRlbmN5IH0gZnJvbSBcIm9jY2FtLW1vZGVsXCI7XG5pbXBvcnQgeyB2ZXJpZmljYXRpb25VdGlsaXRpZXMsIFJlbGVhc2VDb250ZXh0IH0gZnJvbSBcIm9jY2FtLWxhbmd1YWdlc1wiO1xuXG5pbXBvcnQgeyBGaWxlQ29udGV4dEZyb21GaWxlUGF0aCB9IGZyb20gXCIuLi91dGlsaXRpZXMvZmlsZUNvbnRleHRcIjtcbmltcG9ydCB7IHJlbGVhc2VDb250ZXh0RnJvbURlcGVuZGVuY3kgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL3JlbGVhc2VDb250ZXh0XCI7XG5cbmNvbnN0IHsgY3JlYXRlUmVsZWFzZUNvbnRleHQsIHZlcmlmeVJlbGVhc2VDb250ZXh0LCBpbml0aWFsaXNlUmVsZWFzZUNvbnRleHQgfSA9IHZlcmlmaWNhdGlvblV0aWxpdGllcztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QWN0aW9uKG5hbWUsIGxvZykge1xuICBjb25zdCBjYWxsYmFjayA9IGFzeW5jIChjb250ZXh0LCBmaWxlUGF0aCwgbGluZUluZGV4KSA9PiB7XG4gICAgICAgICAgLy8vXG4gICAgICAgIH0sXG4gICAgICAgIHJlbGVhc2VDb250ZXh0TWFwID0ge30sXG4gICAgICAgIGNvbnRleHQgPSB7XG4gICAgICAgICAgbG9nLFxuICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgIHJlbGVhc2VDb250ZXh0TWFwLFxuICAgICAgICAgIEZpbGVDb250ZXh0RnJvbUZpbGVQYXRoLFxuICAgICAgICAgIHJlbGVhc2VDb250ZXh0RnJvbURlcGVuZGVuY3lcbiAgICAgICAgfVxuXG4gIC8vIHRyeSB7XG4gICAgY29uc3QgZGVwZW5kZW50TmFtZXMgPSBbXSxcbiAgICAgICAgICBkZXBlbmRlbmN5ID0gRGVwZW5kZW5jeS5mcm9tTmFtZShuYW1lKSxcbiAgICAgICAgICByZWxlYXNlQ29udGV4dENyZWF0ZWQgPSBhd2FpdCBjcmVhdGVSZWxlYXNlQ29udGV4dChkZXBlbmRlbmN5LCBkZXBlbmRlbnROYW1lcywgY29udGV4dCk7XG5cbiAgICBpZiAoIXJlbGVhc2VDb250ZXh0Q3JlYXRlZCkge1xuICAgICAgbG9nLndhcm5pbmcoYFRoZSAnJHtuYW1lfScgcHJvamVjdCBvciBwYWNrYWdlIGNhbm5vdCBiZSBjcmVhdGVkLmApO1xuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcmVsZWFzZU5hbWUgPSBuYW1lLCAvLy9cbiAgICAgICAgICByZWxlYXNlQ29udGV4dCA9IHJlbGVhc2VDb250ZXh0TWFwW3JlbGVhc2VOYW1lXSxcbiAgICAgICAgICByZWxlYXNlZCA9IHJlbGVhc2VDb250ZXh0LmlzUmVsZWFzZWQoKTtcblxuICAgIGlmIChyZWxlYXNlZCkge1xuICAgICAgbG9nLndhcm5pbmcoYFRoZSAnJHtuYW1lfScgcGFja2FnZSBkb2VzIG5vdCBuZWVkIHRvIGJlIHZlcmlmaWVkLmApO1xuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaW5pdGlhbGlzZVJlbGVhc2VDb250ZXh0KGRlcGVuZGVuY3ksIGNvbnRleHQpO1xuXG4gICAgY29uc3QgZGVwZW5kZW50TmFtZSA9IG51bGwsXG4gICAgICAgICAgZGVwZW5kZW50UmVsZWFzZWQgPSBmYWxzZSxcbiAgICAgICAgICByZWxlYXNlQ29udGV4dFZlcmlmaWVzID0gYXdhaXQgdmVyaWZ5UmVsZWFzZUNvbnRleHQocmVsZWFzZU5hbWUsIGRlcGVuZGVudE5hbWUsIGRlcGVuZGVudFJlbGVhc2VkLCByZWxlYXNlQ29udGV4dE1hcCk7XG5cbiAgICBpZiAoIXJlbGVhc2VDb250ZXh0VmVyaWZpZXMpIHtcbiAgICAgIGxvZy53YXJuaW5nKGBUaGUgJyR7bmFtZX0nIHByb2plY3Qgb3IgcGFja2FnZSBjYW5ub3QgYmUgdmVyaWZpZWQuYCk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBqc29uID0gcmVsZWFzZUNvbnRleHQudG9KU09OKCksXG4gICAgICAgICAgZW50cmllcyA9IHJlbGVhc2VDb250ZXh0LmdldEVudHJpZXMoKSxcbiAgICAgICAgICBjdXN0b21HcmFtbWFyID0gcmVsZWFzZUNvbnRleHQuZ2V0Q3VzdG9tR3JhbW1hcigpLFxuICAgICAgICAgIHJlbGVhc2VDb250ZXh0cyA9IFtcbiAgICAgICAgICAgIHJlbGVhc2VDb250ZXh0XG4gICAgICAgICAgXTtcblxuICAgIFJlbGVhc2VDb250ZXh0LmZyb21Mb2dOYW1lSlNPTkVudHJpZXNDYWxsYmFja0FuZEN1c3RvbUdyYW1tYXIobG9nLCBuYW1lLCBqc29uLCBlbnRyaWVzLCBjYWxsYmFjaywgY3VzdG9tR3JhbW1hcikuaW5pdGlhbGlzZShyZWxlYXNlQ29udGV4dHMsIEZpbGVDb250ZXh0RnJvbUZpbGVQYXRoKTtcblxuXG4gIC8vIH1cbiAgLy8gY2F0Y2ggKGVycm9yKSB7XG4gIC8vICAgbG9nLmVycm9yKGVycm9yKTtcbiAgLy8gfVxufVxuIl0sIm5hbWVzIjpbInZlcmlmeUFjdGlvbiIsImNyZWF0ZVJlbGVhc2VDb250ZXh0IiwidmVyaWZ5UmVsZWFzZUNvbnRleHQiLCJpbml0aWFsaXNlUmVsZWFzZUNvbnRleHQiLCJ2ZXJpZmljYXRpb25VdGlsaXRpZXMiLCJuYW1lIiwibG9nIiwiY2FsbGJhY2siLCJjb250ZXh0IiwiZmlsZVBhdGgiLCJsaW5lSW5kZXgiLCJyZWxlYXNlQ29udGV4dE1hcCIsIkZpbGVDb250ZXh0RnJvbUZpbGVQYXRoIiwicmVsZWFzZUNvbnRleHRGcm9tRGVwZW5kZW5jeSIsImRlcGVuZGVudE5hbWVzIiwiZGVwZW5kZW5jeSIsIkRlcGVuZGVuY3kiLCJmcm9tTmFtZSIsInJlbGVhc2VDb250ZXh0Q3JlYXRlZCIsIndhcm5pbmciLCJyZWxlYXNlTmFtZSIsInJlbGVhc2VDb250ZXh0IiwicmVsZWFzZWQiLCJpc1JlbGVhc2VkIiwiZGVwZW5kZW50TmFtZSIsImRlcGVuZGVudFJlbGVhc2VkIiwicmVsZWFzZUNvbnRleHRWZXJpZmllcyIsImpzb24iLCJ0b0pTT04iLCJlbnRyaWVzIiwiZ2V0RW50cmllcyIsImN1c3RvbUdyYW1tYXIiLCJnZXRDdXN0b21HcmFtbWFyIiwicmVsZWFzZUNvbnRleHRzIiwiUmVsZWFzZUNvbnRleHQiLCJmcm9tTG9nTmFtZUpTT05FbnRyaWVzQ2FsbGJhY2tBbmRDdXN0b21HcmFtbWFyIiwiaW5pdGlhbGlzZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7K0JBWUE7OztlQUE4QkE7OztRQVZ2Qjs0QkFFb0I7Z0NBQzJCOzZCQUVkO2dDQUNLO0FBRTdDLE1BQU0sRUFBRUMsb0JBQW9CLEVBQUVDLG9CQUFvQixFQUFFQyx3QkFBd0IsRUFBRSxHQUFHQyxxQ0FBcUI7QUFFdkYsZUFBZUosYUFBYUssSUFBSSxFQUFFQyxHQUFHO0lBQ2xELE1BQU1DLFdBQVcsT0FBT0MsU0FBU0MsVUFBVUM7SUFDbkMsR0FBRztJQUNMLEdBQ0FDLG9CQUFvQixDQUFDLEdBQ3JCSCxVQUFVO1FBQ1JGO1FBQ0FDO1FBQ0FJO1FBQ0FDLHlCQUFBQSxvQ0FBdUI7UUFDdkJDLDhCQUFBQSw0Q0FBNEI7SUFDOUI7SUFFTixRQUFRO0lBQ04sTUFBTUMsaUJBQWlCLEVBQUUsRUFDbkJDLGFBQWFDLHNCQUFVLENBQUNDLFFBQVEsQ0FBQ1osT0FDakNhLHdCQUF3QixNQUFNakIscUJBQXFCYyxZQUFZRCxnQkFBZ0JOO0lBRXJGLElBQUksQ0FBQ1UsdUJBQXVCO1FBQzFCWixJQUFJYSxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUVkLEtBQUssdUNBQXVDLENBQUM7UUFFakU7SUFDRjtJQUVBLE1BQU1lLGNBQWNmLE1BQ2RnQixpQkFBaUJWLGlCQUFpQixDQUFDUyxZQUFZLEVBQy9DRSxXQUFXRCxlQUFlRSxVQUFVO0lBRTFDLElBQUlELFVBQVU7UUFDWmhCLElBQUlhLE9BQU8sQ0FBQyxDQUFDLEtBQUssRUFBRWQsS0FBSyx1Q0FBdUMsQ0FBQztRQUVqRTtJQUNGO0lBRUFGLHlCQUF5QlksWUFBWVA7SUFFckMsTUFBTWdCLGdCQUFnQixNQUNoQkMsb0JBQW9CLE9BQ3BCQyx5QkFBeUIsTUFBTXhCLHFCQUFxQmtCLGFBQWFJLGVBQWVDLG1CQUFtQmQ7SUFFekcsSUFBSSxDQUFDZSx3QkFBd0I7UUFDM0JwQixJQUFJYSxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUVkLEtBQUssd0NBQXdDLENBQUM7UUFFbEU7SUFDRjtJQUVBLE1BQU1zQixPQUFPTixlQUFlTyxNQUFNLElBQzVCQyxVQUFVUixlQUFlUyxVQUFVLElBQ25DQyxnQkFBZ0JWLGVBQWVXLGdCQUFnQixJQUMvQ0Msa0JBQWtCO1FBQ2hCWjtLQUNEO0lBRVBhLDhCQUFjLENBQUNDLDhDQUE4QyxDQUFDN0IsS0FBS0QsTUFBTXNCLE1BQU1FLFNBQVN0QixVQUFVd0IsZUFBZUssVUFBVSxDQUFDSCxpQkFBaUJyQixvQ0FBdUI7QUFHdEssSUFBSTtBQUNKLGtCQUFrQjtBQUNsQixzQkFBc0I7QUFDdEIsSUFBSTtBQUNOIn0=